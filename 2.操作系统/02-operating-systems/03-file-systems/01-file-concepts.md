# 文件系统基本概念

## 概述

文件系统是操作系统的核心组件，负责管理存储设备上的文件和目录，提供数据的持久化存储和组织功能。

## 核心概念

### 文件定义

- **文件**：存储在设备上的命名数据集合
- **文件属性**：名称、大小、时间戳、权限等
- **文件类型**：普通文件、目录、设备文件、链接

### 文件系统目标

- **持久性**：数据在重启后仍然存在
- **共享性**：多用户和进程可访问
- **安全性**：控制访问权限
- **效率**：快速的文件操作

## 文件组织

### 文件结构

1. **无结构文件**：字节流形式
2. **记录结构文件**：固定或可变长度记录
3. **树形结构文件**：层次化组织

### 访问方式

- **顺序访问**：按顺序读取
- **随机访问**：直接访问任意位置
- **索引访问**：通过索引定位

## 目录结构

### 目录类型

1. **单级目录**：所有文件在同一目录
2. **两级目录**：用户和系统目录分离
3. **树形目录**：层次化结构
4. **图形目录**：支持链接

### 路径概念

- **绝对路径**：从根目录开始
- **相对路径**：从当前目录开始
- **工作目录**：当前默认目录

## 文件分配策略

### 连续分配

- 文件占用连续磁盘块
- 支持随机访问
- 外部碎片严重

### 链接分配

- 文件块通过指针链接
- 支持动态增长
- 不支持随机访问

### 索引分配

- 使用索引块存储指针
- 支持随机访问
- 无外部碎片

## 空闲空间管理

### 管理方法

- **位图**：用位表示使用状态
- **空闲链表**：链接空闲块
- **空闲表**：记录空闲范围

### 分配策略

- **首次适应**：选择第一个足够大的块
- **最佳适应**：选择最小的足够大的块
- **最坏适应**：选择最大的块

## 文件系统类型

### 常见文件系统

- **FAT**：简单可靠，兼容性好
- **NTFS**：支持大文件，安全性好
- **ext4**：Linux标准，性能好
- **HFS+**：macOS文件系统

### 特殊文件系统

- **网络文件系统**：NFS、SMB
- **内存文件系统**：tmpfs、ramfs
- **虚拟文件系统**：proc、sysfs

## 性能优化

### 优化技术

- **缓存**：减少磁盘访问
- **预读**：提前读取数据
- **延迟写**：批量写入
- **日志**：提高可靠性

### 性能指标

- **吞吐量**：单位时间处理数据量
- **延迟**：操作响应时间
- **IOPS**：每秒I/O操作数

## 安全机制

### 访问控制

- **用户权限**：所有者、组、其他
- **操作权限**：读、写、执行
- **访问控制列表**：细粒度控制

### 安全特性

- **加密**：保护文件内容
- **审计**：记录访问日志
- **备份**：数据恢复

## 实际应用

### Linux文件系统

- **VFS**：虚拟文件系统接口
- **ext系列**：ext2、ext3、ext4
- **Btrfs**：新一代文件系统

### Windows文件系统

- **FAT系列**：FAT16、FAT32
- **NTFS**：新技术文件系统
- **ReFS**：弹性文件系统

### macOS文件系统

- **HFS+**：分层文件系统
- **APFS**：Apple文件系统

## 学习目标

1. 理解文件系统基本概念
2. 掌握文件组织方式
3. 理解目录结构设计
4. 掌握文件分配策略
5. 了解性能优化方法

## 相关资源

- 《操作系统概念》
- 《现代操作系统》
- Linux文件系统源码

## 实践项目

1. 实现简单文件系统
2. 分析文件系统性能
3. 设计文件分配算法
